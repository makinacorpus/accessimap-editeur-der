<div>
    <h3 style="display:inline">Edition des POI</h3>

    <button class="btn btn-default pull-right" 
            ng-click="$ctrl.hideAside()" >
        <span class="fa fa-lg fa-chevron-left"></span>
    </button>
  
    <!-- address form -->
    <h4>Chercher des adresses</h4>
    <form>
        <div class="input-group">
            <span class="input-group-addon">
                <span class="fa fa-lg fa-map-marker" aria-hidden="true"></span>
            </span>

            <input 
                ng-model="$ctrl.address.start" 
                type="text" 
                class="form-control" 
                id="startAddress" 
                placeholder="Adresse de départ (ex : 37 rue Monplaisir, Toulouse)">
            
            <input 
                ng-model="$ctrl.address.stop" 
                type="text" 
                class="form-control" 
                id="stopAddress" 
                placeholder="Adresse d'arrivée">

        </div>
        <button class="btn btn-primary btn-block" ng-click="$ctrl.zoomOnPlace()">
            <span class="fa fa-map-marker" aria-hidden="true"></span>
            Positionner
        </button>
    </form>

    <!-- rotate slider -->
    <form>
        <span>Déplacer le curseur pour orienter la carte</span>
        <div class="input-group col-xs-3">
            <span class="input-group-addon">
            <span class="fa fa-repeat" aria-hidden="true"></span>
            </span>
            <slider class="form-control slider-container" ng-model="$ctrl.rotationAngle" ng-change="$ctrl.rotateMap()" min="0" max="360"></slider>
        </div>

    </form>
    
    <!-- POI form -->
    <h4>Ajouter des points d'intérêts</h4>
    <form>
        <ui-select 
            ng-model="$ctrl.queryChosen" 
            ng-disabled="$ctrl.disabled" 
            theme="bootstrap" 
            ng-change="$ctrl.changeStyle()" 
            class="form-control style-selector">

            <ui-select-match placeholder="Sélectionnez un élément">{{$select.selected.name}}</ui-select-match>

            <ui-select-choices repeat="item in $ctrl.queryChoices | filter: $select.search | layerNotSelected:this.geojson | orderBy:['icon','type']">
                <i class="icon-15px fa fa-{{item.icon}}"></i>
                <i ng-if="item.type === 'point'" class="icon-15px fa fa-map-marker"></i>
                <i ng-if="item.type === 'line'" class="icon-15px fa fa-minus"></i>
                <i ng-if="item.type === 'polygon'" class="icon-15px fa fa-square-o"></i>
                <span ng-bind-html="item.name | highlight: $select.search"></span>
            </ui-select-choices>

        </ui-select>

        <ui-select 
            ng-model="$ctrl.styleChosen" 
            ng-disabled="$ctrl.disabled" 
            theme="bootstrap" 
            class="form-control style-selector" >
            
            <ui-select-match placeholder="Sélectionnez un style">{{$select.selected.name}}</ui-select-match>
            <ui-select-choices repeat="item in $ctrl.styleChoices | filter: $select.search" style="max-height: 500px;">
                <span style="display:inline-block;" ng-bind-html="item.name | highlight: $select.search"></span>
                <span  style="max-height:30px" style="display:inline-block;" ng-bind-html="$ctrl.featureIcon(item, $ctrl.queryChosen.type)"></span>
            </ui-select-choices>

        </ui-select>

        <ui-select 
            ng-if="$ctrl.queryChosen.type === 'polygon'" 
            ng-model="$ctrl.colorChosen" 
            ng-disabled="$ctrl.disabled" 
            theme="bootstrap" 
            class="form-control style-selector">
            
            <ui-select-match placeholder="Couleur de fond">{{$select.selected.name}}</ui-select-match>
            <ui-select-choices repeat="item in $ctrl.colors | filter: $select.search" style="max-height: 500px;">
                <span style="display:inline-block;" ng-bind-html="item.name | highlight: $select.search"></span>
            </ui-select-choices>
        
        </ui-select>

        <span ng-if="$ctrl.queryChosen.type === 'polygon'" 
            class="input-group-addon">
            Contour de forme
            <input type="checkbox" ng-model="$ctrl.checkboxModel.contour">
        </span>


        <button 
            ng-if="$ctrl.queryChosen.id !== 'poi'" 
            class="btn btn-primary btn-block" 
            ng-click="$ctrl.downloadData()" 
            type="button">
            <span class="fa fa-cloud-download" aria-hidden="true"></span> 
            Insérer les données d'OSM
        </button>

        <button 
            ng-if="$ctrl.queryChosen.id === 'poi'" 
            class="btn btn-primary btn-block" 
            ng-click="$ctrl.downloadPoi()" 
            type="button">
            <span class="fa fa-plus-circle" aria-hidden="true"></span>
            Ajouter POI
        </button>

    </form>

    <!-- Feature edition -->
    <h4>Gérer les points d'intérêts existants</h4>
    <p ng-if="$ctrl.geojson.length === 0">
        Pas encore de POI !<br/>
        Vous verrez ici les points que vous allez créer via la boîte de création juste au dessus !
    </p>
    <ul class="features-list">
        <li ng-repeat="feature in $ctrl.geojson">
            {{feature.name}}
            <slider 
                class="form-control slider-container" 
                ng-model="feature.simplification" 
                ng-show="feature.geometryType !== 'point'" 
                ng-change="$ctrl.simplifyFeatures(feature)" 
                min="0" 
                max="100">
            </slider>

            <ui-select 
                ng-model="feature.style" 
                ng-disabled="$ctrl.disabled" 
                ng-change="$ctrl.updateFeature(feature.id, feature.style)" 
                theme="bootstrap" 
                class="form-control style-selector" 
                style="width: 150px;">
                
                <ui-select-match placeholder="Sélectionnez un style">{{$select.selected.name}}</ui-select-match>
                <ui-select-choices repeat="item in feature.styleChoices | filter: $select.search">
                    <div ng-bind-html="item.name | highlight: $select.search"></div>
                    <div style="max-height:30px" ng-bind-html="$ctrl.featureIcon(item, feature.geometryType)"></div>
                </ui-select-choices>

            </ui-select>

            <slider 
                ng-if="feature.geometryType === 'point'" 
                class="form-control slider-container" 
                ng-model="feature.rotation" 
                ng-change="$ctrl.rotateFeature(feature)" 
                min="0" 
                max="360">
            </slider>
            
            <ui-select 
                ng-if="feature.geometryType === 'polygon'" 
                ng-model="feature.color" 
                ng-change="$ctrl.updateFeature(feature.id, feature.style)" 
                ng-disabled="$ctrl.disabled" 
                theme="bootstrap" 
                class="form-control style-selector" 
                style="width: 300px;">
                
                <ui-select-match placeholder="Couleur de fond">{{$select.selected.name}}</ui-select-match>
                <ui-select-choices repeat="item in colors | filter: $select.search" style="max-height: 500px;">
                    <span style="display:inline-block;" ng-bind-html="item.name | highlight: $select.search"></span>
                </ui-select-choices>
                
            </ui-select>

            <span 
                ng-if="feature.geometryType === 'polygon'" 
                class="input-group-addon">

                <input 
                    type="checkbox" 
                    ng-model="feature.contour" 
                    ng-change="$ctrl.updateFeature(feature.id, feature.style)">

                <span class="glyphicon glyphicon-unchecked" aria-hidden="true"></span>

            </span>

            <button 
                class="btn btn-default" 
                type="button" 
                ng-click="$ctrl.removeFeature(feature.id)">
                <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
            </button>
        </li>
    </ul>

</div>

