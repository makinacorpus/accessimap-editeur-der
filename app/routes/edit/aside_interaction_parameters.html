<h3>
    <span class="fa fa-hand-pointer-o" aria-hidden="true"></span>
    Interaction
</h3>

<form>

    <h4 class="col-xs-12">
        Filtres
    </h4>

    <table class="table">
        <tr ng-repeat="filter in $ctrl.interactions.getFilters() track by filter.id">
            <td>
                <input type="text" ng-model="filter.name" class="form-control">
            </td>
            <td class="remove-button">
                <button class="btn" ng-click="$ctrl.interactions.removeFilter(filter.id)">
                    <span class="fa fa-lg fa-times" aria-hidden="true"></span>
                </button>
            </td>
        </tr>
        <tr>
            <!-- <td>
                <input type="text" ng-model="filter.name" class="form-control">
            </td> -->
            <td class="plus-button">
                <button class="btn" ng-click="$ctrl.interactions.addFilter(name);
                name = '';">
                    <span class="fa fa-lg fa-plus" aria-hidden="true"></span>
                </button>
            </td>
        </tr>
    </table>
    
    <h4 class="col-xs-12">
        Liste des éléments
    </h4>
    <div class="col-xs-12" ng-show="$ctrl.interactions.getInteractions().length === 0">
        <p>
            Pas encore d'interaction définie !
        </p>
    </div>
    &nbsp;
    <uib-accordion close-others="false" ng-show="$ctrl.showInteractions">
        <uib-accordion-group
            heading="{{poi.id}}"
            ng-repeat="poi in $ctrl.interactions.getInteractions() track by poi.id">
            <div ng-repeat="filter in $ctrl.interactions.getFilters()" class="list-interactions">
                <div class="list-interactions-header">
                    <strong>Filtre : {{filter.name}}</strong>
                </div>
                <div class="list-interactions-item" ng-repeat="interaction in poi.interactions track by $index">
                    <button class="btn btn-sm btn-danger remove-interaction" ng-click="$ctrl.removeInteraction(poi.id, $index)"><span class="fa fa-lg fa-times" aria-hidden="true"></span></button> 
                    <div class="col-sm-6 form-group">
                        <label class="control-label" for="gesture">Déclencheur</label>
                        <select id="gesture" ng-model="interaction.gesture" class="form-control input-sm">
                            <option value="tap">tap</option>
                            <option value="double_tap">double_tap</option>
                        </select>
                    </div>
                    <div class="col-sm-6 form-group">
                        <label class="control-label" for="protocol">Nature du son</label>
                        <select id="protocol" ng-model="interaction.protocol" class="form-control input-sm">
                            <option>tts</option>
                            <option>mp3</option>
                        </select>
                    </div>
                    <div class="col-sm-12 form-group">
                        <input id="valuetts" type="text" class="form-control input-sm"
                            placeholder="Valeur (ce qui sera lu)"
                            ng-model="interaction.value"
                            ng-if="interaction.protocol==='tts'"
                            style="width:100%">
                        
                        <input id="valuemp3" type="file" class="form-control input-sm"
                            placeholder="Valeur (le son qui sera joué)"
                            ng-model="interaction.value"
                            ng-if="interaction.protocol==='mp3'"
                            style="width:100%">
                    </div>
                </div>
                <div class="list-interactions-footer">
                    <button class="btn btn-primary btn-block" ng-click="$ctrl.addInteraction(poi.id)">
                        Nouvelle interaction
                    </button>
                </div>
            </div>
        </uib-accordion-group>
    </uib-accordion>

    <p class="col-xs-12" ng-if="!$ctrl.currentFeature">
        Vous devez d'abord sélectionner un élément pour ajouter une interaction.
    </p>

</form>